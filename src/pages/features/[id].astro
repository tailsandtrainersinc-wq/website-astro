---
import { getCollection, render } from "astro:content";
import Layout from "../../layouts/Layout.astro";
import Header from "../../components/Header.astro";
import Footer from "../../components/Footer.astro";
import { Icon } from "astro-icon/components";
import { SITE } from "../../config/site.mjs";

export async function getStaticPaths() {
  const features = await getCollection("features");
  return features.map((entry) => ({
    params: { id: entry.id },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const { Content } = await render(entry);
const { title, description, icon } = entry.data;
---

<Layout
  title={`${title} | ${SITE.title}`}
  description={description}
  canonicalURL={`${SITE.url}/features/${entry.id}`}
>
  <Header />
  <main id="main-content" role="main">
    <article class="max-w-4xl mx-auto px-6 md:px-12 pt-32" style="padding-bottom: var(--space-section);">
      <!-- Back link -->
      <a
        href="/features"
        class="inline-flex items-center gap-2 mb-10 px-4 py-2 rounded-full text-sm font-medium transition-all duration-300"
        style="background: var(--surface-raised); color: var(--text-secondary); border: 1px solid oklch(0.30 0.03 290 / 0.3);"
      >
        <Icon name="tabler:arrow-left" class="w-4 h-4" aria-hidden="true" />
        Back to What We Do
      </a>

      <header class="mb-12">
        {/* Large icon with glow */}
        <div
          class="w-20 h-20 rounded-3xl flex items-center justify-center mb-8"
          style="background: oklch(0.72 0.18 25 / 0.12); color: var(--accent-warm); box-shadow: 0 0 40px oklch(0.72 0.18 25 / 0.1);"
        >
          <Icon name={icon} class="w-10 h-10" aria-hidden="true" />
        </div>

        <h1
          class="mb-4 leading-tight"
          style="font-family: var(--font-serif); font-size: var(--text-display); color: var(--text-primary);"
        >
          {title}
        </h1>
        <p style="font-size: var(--text-subhead); color: var(--text-secondary);">
          {description}
        </p>
      </header>

      <div class="prose prose-invert prose-lg max-w-none">
        <Content />
      </div>

      {entry.id === "get-involved" && (
        <div
          class="mt-16 p-8 rounded-3xl text-center"
          style="background: var(--surface-mid); border: 1px solid oklch(0.25 0.02 280 / 0.4);"
        >
          <p class="mb-5" style="color: var(--text-secondary); font-size: var(--text-subhead);">
            Ready to make a difference?
          </p>
          <a href="/contact" class="btn-primary">
            Contact Us
          </a>
        </div>
      )}
    </article>
  </main>
  <Footer />
</Layout>

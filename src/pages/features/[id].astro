---
import { getCollection, getEntry, render } from "astro:content";
import Layout from "../../layouts/Layout.astro";
import Header from "../../components/Header.astro";
import Footer from "../../components/Footer.astro";
import { Icon } from "astro-icon/components";
import { SITE } from "../../config/site.mjs";

export async function getStaticPaths() {
  const features = await getCollection("features");
  return features.map((entry) => ({
    params: { id: entry.id },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const { Content } = await render(entry);
const { title, description, icon } = entry.data;
---

<Layout
  title={`${title} | ${SITE.title}`}
  description={description}
  canonicalURL={`${SITE.url}/features/${entry.id}`}
>
  <Header />
  <main id="main-content" role="main">
    <article class="max-w-4xl mx-auto px-4 py-16">
      <a
        href="/features"
        class="inline-flex items-center gap-2 text-taupe hover:text-brass transition-colors mb-8 text-sm"
      >
        &larr; Back to What We Do
      </a>
      <header class="mb-10">
        <div class="w-14 h-14 bg-brass/15 rounded-xl flex items-center justify-center mb-6 text-brass">
          <Icon name={icon} class="w-7 h-7" aria-hidden="true" />
        </div>
        <h1 class="text-4xl md:text-5xl font-bold text-cream mb-4 font-[var(--font-display)]">{title}</h1>
        <p class="text-xl text-taupe">{description}</p>
      </header>
      <div class="prose prose-invert prose-lg max-w-none">
        <Content />
      </div>
      {entry.id === "get-involved" && (
        <div class="mt-12 p-6 bg-leather-raised/80 rounded-xl border border-brass/20 text-center">
          <p class="text-taupe mb-4">Ready to make a difference?</p>
          <a
            href="/contact"
            class="btn-primary btn-wag"
          >
            Contact Us
          </a>
        </div>
      )}
    </article>
  </main>
  <Footer />
</Layout>
